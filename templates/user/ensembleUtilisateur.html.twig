{% extends 'base.html.twig' %}

{% block title %}Ensemble Utilisateurs{% endblock %}

{% block body %}

    <div class="container">
        <div class="row justify-content-center mt-3">
            <div class="col-lg-6">
                <h3 class="text-center mb-3">Liste des utilisateurs</h3>

                <nav class="justify-content-around bg-light p-3 mb-3">
                    <div class="col form-floating">
                        <input class="form-control me-2" id="inputSaisi" type="search" aria-label="Search">
                        <label for="inputSaisi">Recherche</label>
                    </div>
                </nav>

                <!-- AJAX pour la recherche des utilisateurs -->
                <script> const rechercheUtilisateurUrl = "{{ path('user_rechercheParNomPrenomPseudo') }}" </script>
                <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
                <script>
                    let rechercheSaisi = document.getElementById("inputSaisi");
                    rechercheSaisi.addEventListener("keyup", envoyerAjaxRequest);

                    function envoyerAjaxRequest() {
                        let saisi = rechercheSaisi.value;
                        console.log(saisi);
                        axios.get(rechercheUtilisateurUrl, {
                            params: {"saisi": saisi}
                        })
                            .then(function (response) {
                                console.log(response.data);
                                let listeResultats = document.getElementById("listeUtilisateurs");
                                listeResultats.innerHTML = response.data;
                            });
                    }
                </script>
                <!-- fin: AJAX pour des utilisateurs -->

                <div class="table-wrapper-scroll-y my-custom-scrollbar-list-users">
                    <table class="table table-striped table-bordered table">
                        <thead>
                        <tr>
                            <th scope="col">Pseudo</th>
                            <th scope="col">Nom</th>
                        </tr>
                        </thead>
                        <tbody id="listeUtilisateurs">
                        {% for user in users %}
                            <tr>
                                <td><a href="{{ path('user_profilUtilisateur', {'id' : user.id } ) }}">{{ user.pseudo }}
                                </td>
                                <td>{{ user.prenom }} {{ user.nom }}</td>
                            </tr>
                        {% else %}
                            <tr>
                                <td scope="row">Pas de utilisateur !</td>
                            </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

{% endblock %}



