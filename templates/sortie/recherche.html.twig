{% extends 'base.html.twig' %}

{% block title %}Hello ParticipantController!{% endblock %}

{% block body %}


<div >
    <div>
        <div class="container border mt-5 rounded">

            <div class="row justify-content-center mt-2">
{#                <div class="col-12 col-sm-10 col-md-8 col-lg-8 row">#}

{#                    {% for flashError in app.flashes('verify_email_error') %}#}
{#                        <div class="alert alert-danger" role="alert">{{ flashError }}</div>#}
{#                    {% endfor %}#}
                <div class="mt-2 ml-10">
                    <h1 class=" font-weight-small ml-5">Filtrer les sorties</h1>
                </div>

                    {{ form_start(rechercheForm) }}
                <div class="container row m-3 justify-content-around">

                    <div class="col-10 col-sm-5 justify-content-center  ml-5">
                        <div class="mb-3 col-11  row ">
                            <div class="input ">{{ form_label(rechercheForm.site) }}</div>
                            <div class="col-sm-10">{{ form_widget(rechercheForm.site, {'attr' : {'class': 'form-select'}}) }}</div>
                        </div>
                        <div class="mb-3 row">
                            <div class="form-label ">{{ form_label(rechercheForm.nom) }}</div>
                            <div class="col-sm-10">{{ form_widget(rechercheForm.nom, {'attr' : {'class': 'form-control'}}) }}</div>
                        </div>


                        <div class="mb-3 row ">
                            <div class="col-sm-5 col-form-label ">
                            {{ form_label(rechercheForm.dateMin) }}{{ form_widget(rechercheForm.dateMin, {'attr' : {'class': 'form-control'}}) }}
                            </div>
                            <div class="col-sm-5 col-form-label ">
                            {{ form_label(rechercheForm.dateMax) }} {{ form_widget(rechercheForm.dateMax, {'attr' : {'class': 'form-control'}}) }}
                            </div>
                        </div>
                    </div>

                    <div class="form-check col-10 col-sm-5 justify-content-center mt-3 ml-5">
                        <div class="mb-3 col-10">
                            {{ form_widget(rechercheForm.organisateur, {'attr' : {
                                'class': 'form-check-input',
                            }}) }}
                            <div class="form-label">{{ form_label(rechercheForm.organisateur) }}</div>

                        </div>
                        <div class="mb-3">
                            {{ form_widget(rechercheForm.inscrit, {'attr' : {'class': 'form-check-input'}}) }}
                            <div class="form-label">{{ form_label(rechercheForm.inscrit) }}</div>

                        </div>
                        <div class="mb-3">

                            {{ form_widget(rechercheForm.pasInscrit, {'attr' : {'class': 'form-check-input'}}) }}
                            <div class="form-label">{{ form_label(rechercheForm.pasInscrit) }}</div>
                        </div>
                        <div class="mb-3">

                            {{ form_widget(rechercheForm.passees, {'attr' : {'class': 'form-check-input'}}) }}
                            <div class="form-label">{{ form_label(rechercheForm.passees) }}</div>
                        </div>
                        <div class="  m-4 mt-5">
                        <button type="submit" class="btn btn-lg btn-primary">Rechercher</button>
                        {{ form_end(rechercheForm) }}
                        </div>

                    </div>
                 </div>
            </div>
        </div>
    </div>

    <div class="container border mt-5 rounded">
        <div>
            <div>
                <table class="table">
                    <thead class="thead-dark">
                    <tr>
                        <div><th scope="col">Nom de la sortie</th></div>
                        <div><th scope="col">Date de la sortie</th></div>
                        <div><th scope="col">Cloture</th></div>
                        <div><th scope="col">Inscrits/places</th></div>
                        <div><th scope="col">Etat</th></div>
                        <div><th scope="col">Inscrit</th></div>
                        <div><th scope="col">Organisateur</th></div>
                        <div><th scope="col">Actions</th></div>
                    </tr>
                    </thead>
                    <tbody>
                    Nombre de sorties trouvées : {{ resultat.nbSorties }}
                    {% for sortie in resultat.sorties %}
                    <tr>
                        <td>{{ sortie.nom }}</td>
                        <td>{{ sortie.dateHeureDebut|date }}</td>
                        <td>{{ sortie.dateLimiteInscription|date }}</td>
                        <td>
                            <div class="text-center">{{ sortie.participants|length }}/{{ sortie.nbInscriptionMax }}</div>
                        </td>
                        <td>{{ sortie.etat.libelle }}</td>
                        <td >{% if (app.user in sortie.participants) %}
                               <div class="text-center " >X</div>
                            {% else  %}
                            {{ null }}
                            {% endif %}
                        </td>
                        <td><a href="{{ path('user_profilUtilisateur', {'id' : sortie.organisateur.id}) }}">{{ sortie.organisateur.pseudo }}</a></td>
                        <td>
                            <a href="{{ path('sortie_detail',{'id': sortie.id}) }}">Détail</a>
{#                            {% if app.user.admin %}#}
{#                                <a href="{{  path('sortie_activer',{'id': sortie.id}) }}">Activer</a>#}
{#                            {% endif %}#}
                            {% if (sortie.etat.libelle == 'Ouverte') and (sortie.organisateur != app.user) %}
                            <button type="submit" class="btn btn-link"><a href="{{ path('sortie_inscription', {'id' : sortie.id}) }}">S'inscrire</a></button>
                            {% endif %}
                        </td>
                        
                    </tr>

                    {% endfor %}
                    </tbody>
                </table>

            </div>
        </div>
    </div>
</div>
{% endblock %}
